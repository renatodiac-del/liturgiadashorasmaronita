<!-- patristica-autor.html — hero redondo, botões com ícone cruz3.png (borda dourada), sem subtítulo, Voltar perto dos botões (para patristica.html) -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Patrística — Autor</title>
<style>
:root{--areia-clara:#efe1c7;--areia-media:#e6d6b4;--areia-escura:#c2a772;--ouro:#b4923a;--preto:#111;--shadow:rgba(0,0,0,.18);--sans:Arial,Helvetica,sans-serif;--vermelho:#a00000;}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  font-family:var(--sans); color:#2b2114;
  background:
    radial-gradient(1px 1px at 15% 25%, rgba(255,255,255,.8), transparent 60%),
    radial-gradient(1px 1px at 75% 12%, rgba(255,255,255,.75), transparent 60%),
    radial-gradient(1px 1px at 55% 70%, rgba(255,255,255,.7), transparent 60%),
    radial-gradient(1px 1px at 28% 58%, rgba(255,255,255,.8), transparent 60%),
    linear-gradient(to top, var(--areia-escura), var(--areia-media), var(--areia-clara));
  display:flex; flex-direction:column; min-height:100vh;
}
.wrap{max-width:640px;margin:0 auto;padding:12px 16px 22px;width:100%}
.title{
  text-align:center; font-size:calc(1.9rem + 3pt); font-weight:900; color:#111;
  text-shadow:-1px -1px 0 var(--ouro), 1px -1px 0 var(--ouro),
              -1px  1px 0 var(--ouro), 1px  1px 0 var(--ouro);
  margin-bottom:8px;
}
/* HERO redondo com borda dourada */
.hero{
  display:block;margin:8px auto 10px;
  width:260px; height:260px; object-fit:cover; object-position:center;
  border:6px solid var(--ouro);
  box-shadow:0 8px 18px var(--shadow), 0 0 0 4px rgba(180,146,58,.45);
  border-radius:50%;
  background:#fff7e6;
}
.rotate-left-90{ transform:rotate(-90deg); }

/* Voltar perto dos botões */
.top-actions{display:flex; justify-content:center; margin:6px 0 10px;}
.voltar{
  background:var(--vermelho); color:#fff; font-size:.8rem; font-weight:bold;
  border:none; border-radius:10px; padding:.45rem .8rem; cursor:pointer;
  text-decoration:none; display:inline-flex; align-items:center; gap:.45rem;
  box-shadow:0 2px 6px var(--shadow);
}
.voltar:hover{background:#c00000}

.actions{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:8px;width:100%}
.actionBtn{
  position:relative; display:flex; align-items:center; justify-content:center; gap:10px;
  text-align:center; min-height:64px; padding:12px 14px 12px 56px;
  border-radius:14px; text-decoration:none; background:#fff; color:#2b2114; font-weight:800;
  border:3px solid var(--ouro); box-shadow:inset 0 0 0 3px rgba(180,146,58,.45), 0 3px 8px var(--shadow);
}
.actionBtn[aria-disabled="true"]{opacity:.45;pointer-events:none}
/* Ícone cruz3 dentro do botão (esquerda), redondo com borda dourada */
.actionBtn .mini{
  position:absolute; left:12px; width:32px; height:32px; border-radius:50%; object-fit:cover;
  border:3px solid var(--ouro); box-shadow:0 0 0 2px rgba(180,146,58,.35);
}

.alert{margin:10px auto;width:90%;max-width:520px;background:#fff3cd;color:#7c5b00;border:1px solid #ffe08a;padding:6px 10px;font-size:.9rem;border-radius:8px;text-align:center;display:none}
</style>
</head>
<body>
  <main class="wrap">
    <h1 id="title" class="title">Patrística — Autor</h1>
    <img id="hero" class="hero" src="img/icone-patristica.png" alt="Autor">
    <div id="alert" class="alert"></div>

    <div class="top-actions">
      <a class="voltar" href="patristica.html">&#8592; Voltar</a>
    </div>

    <section id="actions" class="actions" aria-label="Links do autor"></section>
  </main>

<script>
// ====== CONFIG ======
var CSV_LINKS = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTSNOwDCcQPyPihUkD8PbrtAmMjV9gcYgCmOXNnAfK6chO41qAAtltEpzl-mlxEvlnMwGQQ-JgKjMI3/pub?gid=101845558&single=true&output=csv";
var BUTTON_ORDER = ['biografia','homilias','hinos','obras'];
var LABELS = { biografia:'Biografia', homilias:'Homilias', hinos:'Hinos', obras:'Obras selecionadas' };

// Nome e ícone por slug
var AUTHOR_META = {
  'santo-efrem':        {name:'Santo Efrém',        icon:'img/efrem.png', rotate:true},
  'narsai-de-nisibis':  {name:'Narsai de Nisibis',  icon:'img/narsai-nisibis.png'},
  'jaco-de-serugh':     {name:'Jacó de Serugh',     icon:'img/jaco-serugh.png'},
  'isaque-de-ninive':   {name:'Isaque de Nínive',   icon:'img/isaque-ninive.jpeg'}
};

// ====== HELPERS ======
function getSlug(){
  var h=(location.hash||'').replace(/^#/,'').trim();
  if(h) return h;
  var m=location.search.match(/[?&]a=([^&]+)/i);
  return m ? decodeURIComponent(m[1]) : 'santo-efrem';
}

// CSV parse (compatível com Google Sheets)
function parseCSV(text){
  text = (text||'').replace(/^\uFEFF/,'');
  var lines = text.split(/\r?\n/).filter(function(l){return l.trim()!==''});
  var rows=[];
  for(var li=0; li<lines.length; li++){
    var line=lines[li], cur='', q=false, row=[];
    for(var i=0;i<line.length;i++){
      var c=line[i];
      if(c=='"'){ if(q && line[i+1]=='"'){ cur+='"'; i++; } else { q=!q; } }
      else if(c===',' && !q){ row.push(cur); cur=''; }
      else { cur+=c; }
    }
    row.push(cur);
    rows.push(row.map(function(x){return x.trim();}));
  }
  return rows;
}
function normHeader(h){
  if(!h) return '';
  var s=(''+h).toLowerCase();
  if(s.normalize){ s=s.normalize('NFD').replace(/[\u0300-\u036f]/g,''); }
  s=s.replace(/[^a-z0-9]+/g,'_').replace(/^_+|_+$/g,'');
  return s;
}

// ====== RENDER ======
var titleEl=document.getElementById('title');
var hero=document.getElementById('hero');
var actions=document.getElementById('actions');
var alertBx=document.getElementById('alert');

function renderAuthorHeader(slug){
  var meta = AUTHOR_META[slug] || {name:slug, icon:'img/icone-patristica.png'};
  titleEl.textContent = meta.name;
  hero.src = meta.icon;
  hero.alt = meta.name;
  if(meta.rotate){ hero.classList.add('rotate-left-90'); } else { hero.classList.remove('rotate-left-90'); }
}

function buildButtonsFor(slug, rows){
  actions.innerHTML='';
  var head = rows[0]||[];
  var map={}; for(var i=0;i<head.length;i++) map[normHeader(head[i])]=i;
  var data = rows.slice(1).filter(function(r){
    return (r[map.author_slug]||'').trim()===slug;
  });
  var byKey = {};
  for(var i=0;i<data.length;i++){
    var r=data[i];
    var key=((r[map.button_key]||'')+'').toLowerCase().trim();
    if(!key) continue;
    byKey[key] = {
      label:(r[map.label]||LABELS[key]||key),
      url:(r[map.url]||''),
      enabled:String(r[map.enabled]||'1').trim()
    };
  }
  BUTTON_ORDER.forEach(function(key){
    var d = byKey[key] || {label:LABELS[key], url:'', enabled:'0'};
    var A=document.createElement('a');
    A.className='actionBtn';
    // ícone cruz à esquerda
    var img=document.createElement('img');
    img.src='img/cruz3.png';
    img.alt='';
    img.className='mini';
    A.appendChild(img);
    // rótulo
    var span=document.createElement('span');
    span.textContent=d.label||LABELS[key]||key;
    A.appendChild(span);
    // habilita/ desabilita
    var on=d.url && d.enabled==='1';
    if(on){ A.href=d.url; A.target='_blank'; A.rel='noopener'; }
    else{ A.href='#'; A.setAttribute('aria-disabled','true'); }
    actions.appendChild(A);
  });

  if(!Object.keys(byKey).length){
    alertBx.textContent='Nenhum link encontrado para este autor na aba "patristica-links".';
    alertBx.style.display='block';
  }else{
    alertBx.style.display='none';
  }
}

// ====== BOOT ======
(function init(){
  var slug = getSlug();
  renderAuthorHeader(slug);

  fetch(CSV_LINKS + '&t=' + Date.now(), {cache:'no-store'})
    .then(function(res){ if(!res.ok) throw new Error(res.status); return res.text(); })
    .then(function(txt){
      var rows = parseCSV(txt);
      if(!rows.length) throw new Error('CSV vazio');
      buildButtonsFor(slug, rows);
    })
    .catch(function(err){
      alertBx.textContent='Erro ao carregar links: ' + err;
      alertBx.style.display='block';
    });
})();
</script>
</body>
</html>

