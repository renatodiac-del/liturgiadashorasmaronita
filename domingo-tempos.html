<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Domingo · Tempos</title>
<meta name="theme-color" content="#d6b25a">
<style>
*{box-sizing:border-box} html,body{height:100%}
:root{ --ouro:#d6b25a; --marrom:#582c0c; --shadow:rgba(0,0,0,.15); --fonte:Arial,Helvetica,sans-serif; }
body{
  margin:0; font-family:var(--fonte); background:#d6b25a; color:#1b1b1b;
  background-image:
    repeating-linear-gradient(45deg, rgba(88,44,12,.22) 0 2px, transparent 2px 40px),
    repeating-linear-gradient(-45deg, rgba(88,44,12,.22) 0 2px, transparent 2px 40px);
  background-size:40px 40px; display:flex; flex-direction:column; min-height:100vh;
}
header{text-align:center;padding:12px 12px 0}
.title{
  margin:0; font-weight:900; font-size:1.6rem; color:#3b200b;
  text-shadow:-1px -1px 0 var(--ouro),1px -1px 0 var(--ouro),-1px 1px 0 var(--ouro),1px 1px 0 var(--ouro)
}
.wrap{max-width:640px;margin:0 auto;padding:8px 16px 24px;width:100%}
.hero{
  display:block;margin:8px auto 14px;max-width:100%;height:auto;max-height:380px;
  border:6px solid var(--marrom);box-shadow:0 0 0 4px var(--ouro) inset,0 6px 16px var(--shadow);border-radius:14px
}

/* Lista de botões */
.buttons{display:flex;flex-direction:column;gap:12px;align-items:center}
.btn-row{position:relative;width:100%;display:flex;justify-content:center;align-items:center}
.blink-arr{
  position:absolute; top:-8px; font-size:22px; line-height:1; color:#a00000;
  text-shadow:0 1px 0 rgba(0,0,0,.15);
  animation:blink 0.6s ease-in-out 4 forwards;
}
.blink-arr.left{left:6px}
.blink-arr.right{right:6px}
@keyframes blink{ 0%,100%{opacity:0} 50%{opacity:1} }

.btn{
  position:relative;display:flex;align-items:center;justify-content:center;text-align:center;text-decoration:none;
  color:var(--marrom);background:#fff;font-weight:900;border:3px solid var(--marrom);border-radius:18px;
  padding:7px 18px; width:78%;
  box-shadow:inset 0 0 0 3px var(--ouro),0 4px 10px var(--shadow);transition:.15s;
}
.btn:hover{transform:scale(1.02);background:#fff9f0}
.btn img{
  position:absolute;left:12px;width:18px;height:18px;
  border-radius:50%;object-fit:cover;border:2px solid var(--ouro)
}
.label{width:100%}
.line1{display:block;color:var(--ouro);font-size:1.0rem; line-height:1.05}
.line2{display:block;color:#000;font-size:.80rem; line-height:1.05}

/* Voltar pequeno, perto do último botão */
footer{margin-top:6px;text-align:center;padding:6px 0 10px}
.back{
  display:inline-flex;align-items:center;gap:8px;background:#a00000;color:#fff;text-decoration:none;
  border:1px solid #6f0000;padding:.36rem .62rem;border-radius:9px;font-weight:800;font-size:.9rem;transform:scale(.39)
}
.back:hover{background:#c00000}
</style>
</head>
<body>
<header><h1 class="title">Domingo · Tempos</h1></header>

<main class="wrap">
  <img class="hero" src="img/icone-tempos.jpg" alt="Ícone — Tempos">

  <section class="buttons" aria-label="Ações do dia">
    <!-- 1) Tempo do Anúncio -->
    <div class="btn-row">
      <span class="blink-arr left">⬇</span><span class="blink-arr right">⬇</span>
      <a class="btn" href="anuncio.html">
        <img src="img/icone-tempos.jpg" alt="">
        <span class="label"><span class="line1">Tempo do Anúncio</span></span>
      </a>
    </div>

    <!-- 2) Tempo Epifania -->
    <div class="btn-row">
      <span class="blink-arr left">⬇</span><span class="blink-arr right">⬇</span>
      <a class="btn" href="tempos-tempos.html">
        <img src="img/icone-tempos.jpg" alt="">
        <span class="label"><span class="line1">Tempo Epifania</span></span>
      </a>
    </div>

    <!-- 3) Tempo Pentecostes -->
    <div class="btn-row">
      <span class="blink-arr left">⬇</span><span class="blink-arr right">⬇</span>
      <a class="btn" href="tempos-tempos.html">
        <img src="img/icone-tempos.jpg" alt="">
        <span class="label"><span class="line1">Tempo Pentecostes</span></span>
      </a>
    </div>

    <!-- 4) Tempo da Cruz -->
    <div class="btn-row">
      <span class="blink-arr left">⬇</span><span class="blink-arr right">⬇</span>
      <a class="btn" href="tempos-tempos.html">
        <img src="img/icone-tempos.jpg" alt="">
        <span class="label"><span class="line1">Tempo da Cruz</span></span>
      </a>
    </div>

    <!-- 5) Ramsho (versão longa) — via Tempos -->
    <div class="btn-row">
      <span class="blink-arr left">⬇</span><span class="blink-arr right">⬇</span>
      <a class="btn" data-link="ramsho-longa" href="#" target="_blank" rel="noopener">
        <img src="img/cruz2.jpg" alt="">
        <span class="label"><span class="line1">Ramsho</span><span class="line2">versão longa</span></span>
      </a>
    </div>

    <!-- 6) Safro (versão longa) — via Tempos -->
    <div class="btn-row">
      <span class="blink-arr left">⬇</span><span class="blink-arr right">⬇</span>
      <a class="btn" data-link="safro-longa" href="#" target="_blank" rel="noopener">
        <img src="img/cruz2.jpg" alt="">
        <span class="label"><span class="line1">Safro</span><span class="line2">versão longa</span></span>
      </a>
    </div>
  </section>
</main>

<footer>
  <a class="back" href="javascript:history.back()"
     onclick="if(!document.referrer || !document.referrer.includes('tempos.html')){this.href='tempos.html'}">← Voltar</a>
</footer>

<script>
/* Lê os LINKS dos dois botões finais a partir da aba "Tempos" publicada (coluna D, linhas 5 e 3) */
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTSNOwDCcQPyPihUkD8PbrtAmMjV9gcYgCmOXNnAfK6chO41qAAtltEpzl-mlxEvlnMwGQQ-JgKjMI3/pub?gid=1404816220&single=true&output=csv";

/* Parser CSV que suporta campos entre aspas e vírgulas dentro de células */
function parseCsv(text){
  const rows = [];
  let i=0, field="", row=[], inQuotes=false;
  while(i < text.length){
    const c = text[i];
    if (inQuotes){
      if (c === '"'){
        if (text[i+1] === '"'){ field+='"'; i++; }
        else inQuotes=false;
      } else field += c;
    } else {
      if (c === '"'){ inQuotes=true; }
      else if (c === ','){ row.push(field); field=""; }
      else if (c === '\n'){ row.push(field); rows.push(row); row=[]; field=""; }
      else if (c === '\r'){ /* ignora */ }
      else field += c;
    }
    i++;
  }
  if (field!=="" || row.length){ row.push(field); rows.push(row); }
  return rows;
}

/* Constrói um array de colunas (transposto) para acesso por [coluna][linha] */
async function loadCols(){
  const res = await fetch(CSV_URL, {cache:"no-store"});
  const txt = await res.text();
  const rows = parseCsv(txt);
  const cols = [];
  for(let c=0;c<(rows[0]?.length||0);c++){
    cols[c] = rows.map(r => (r[c] ?? ""));
  }
  return cols;
}

/* Helper: devolve string limpa da célula */
function cell(cols, colIndex, rowIndex){
  return (cols[colIndex]?.[rowIndex] || "").trim();
}

/* Aplicar apenas nos dois botões finais (data-link) */
(async ()=>{
  try{
    const cols = await loadCols();
    const COL_D = 3;          // Coluna D = Domingo (0=A,1=B,2=C,3=D)
    const ROW_SAFRO_LONGA  = 2; // Linha 3 (Safro longa) -> índice zero 2
    const ROW_RAMSHO_LONGA = 4; // Linha 5 (Ramsho longa) -> índice zero 4

    const map = {
      "safro-longa":  cell(cols, COL_D, ROW_SAFRO_LONGA),
      "ramsho-longa": cell(cols, COL_D, ROW_RAMSHO_LONGA),
    };

    document.querySelectorAll('[data-link]').forEach(a=>{
      const k = a.getAttribute('data-link');
      const url = (map[k] || "").trim();
      if (url){
        a.href = url;
      } else {
        a.style.opacity = .6;
        a.style.pointerEvents = 'none';
        a.title = 'Link não configurado';
      }
    });
  }catch(e){
    console.error(e);
    document.querySelectorAll('[data-link]').forEach(a=>{
      a.style.opacity=.6;
      a.style.pointerEvents='none';
      a.title='Erro ao carregar links';
    });
  }
})();

/* Remover as setas após piscar 4x */
document.querySelectorAll('.blink-arr').forEach(el=>{
  el.addEventListener('animationend', ()=>{ el.style.display='none'; }, {once:true});
});
</script>
</body>
</html>
