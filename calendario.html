<!-- calendario.html — integrado ao Google Sheets (CSV) com 3 botões (2024, 2025, 2026) -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Calendário Litúrgico</title>
<link rel="stylesheet" href="/components/antero-ui.css"><!-- se existir no projeto -->
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
.container{max-width:720px;margin:auto;padding:16px}
.h1{font-size:1.6rem;margin:6px 0 10px}
.hero{display:flex;align-items:center;gap:12px;margin:6px 0 14px}
.hero img{width:64px;height:64px;border-radius:16px;border:4px solid var(--ouro,#c8a646);object-fit:cover}
.grid-3{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:560px){.grid-3{grid-template-columns:repeat(3,1fr)}}
.card{display:flex;align-items:center;justify-content:center;padding:16px;min-height:92px;text-decoration:none;border-radius:1rem;border:4px double var(--ouro,#c8a646);box-shadow:inset 0 2px 0 rgba(255,255,255,.25),0 3px 12px rgba(0,0,0,.2);background:#fff;color:#222;font-weight:800}
.card small{display:block;font-weight:600;opacity:.85}
.card[aria-disabled="true"]{opacity:.45;pointer-events:none}
.btn-back{background:#a00000;color:#fff;border:none;border-radius:999px;padding:10px 16px;box-shadow:inset 0 2px 0 rgba(255,255,255,.25),0 3px 12px rgba(0,0,0,.2);cursor:pointer}
</style>
</head>
<body data-module="calendario" data-page-slug="calendario">
<div class="container">
<button id="btn-voltar" class="btn-back" aria-label="Voltar">⟵ Voltar</button>


<header class="hero">
<img src="/img/icone-calendario.png" alt="Ícone Calendário" onerror="this.hidden=true">
<h1 class="h1">Calendário Litúrgico</h1>
</header>


<section id="anos" class="grid-3" aria-label="Calendários por ano">
<!-- preenchido via JS -->
</section>
</div>


<script>
// URL pública da aba "calendario" (CSV)
const CSV_CALEND = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTSNOwDCcQPyPihUkD8PbrtAmMjV9gcYgCmOXNnAfK6chO41qAAtltEpzl-mlxEvlnMwGQQ-JgKjMI3/pub?gid=630771061&single=true&output=csv';


// utilidades
const $ = (s,el=document)=>el.querySelector(s);
const csvToRows = (csv)=>csv.trim().split(/\r?\n/).map(l=>l.split(/,(?=(?:[^"]*"[^"]*")*[^"]*$)/).map(s=>s.replace(/^"|"$/g,'')));
async function loadCSV(url){ const r=await fetch(url+'&t='+Date.now(),{cache:'no-store'}); if(!r.ok) throw new Error('CSV'); const t=await r.text(); const [h,...rs]=csvToRows(t); return rs.map(r=>Object.fromEntries(h.map((k,i)=>[k.trim(),(r[i]||'').trim()]))); }


// Voltar com fallback simples → index-teste.html se não houver histórico
(function(){ const b=$('#btn-voltar'); if(!b) return; b.onclick=(e)=>{ e.preventDefault(); const ref=document.referrer||''; if(ref){ history.back(); } else { location.href='index-teste.html?from=fallback'; } }; })();


(async function(){
const rows = await loadCSV(CSV_CALEND);
// Esperado: module,page,button_key,url,enabled
// Filtra só linhas enabled
const enabled = rows.filter(r=> (r.enabled==1||r.enabled==='1') );
