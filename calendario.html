<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Calendário Litúrgico</title>
<meta name="theme-color" content="#0b1f3d">
<style>
  :root{
    --azul:#0b1f3d; --bordo:#6b0010; --ouro:#b4923a; --shadow:rgba(0,0,0,.18);
    --fonte: Arial, Helvetica, sans-serif;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:var(--fonte); color:#fff;
    background:
      radial-gradient(circle at 20% 30%, rgba(255,255,255,.9) 1.6px, transparent 2.4px) 0 0/36px 36px,
      radial-gradient(circle at 70% 60%, rgba(255,255,255,.8) 1.6px, transparent 2.4px) 0 0/36px 36px,
      radial-gradient(circle at 40% 80%, rgba(255,255,255,.65) 1.2px, transparent 2.2px) 0 0/28px 28px,
      radial-gradient(circle at 85% 25%, rgba(255,255,255,.5) 1.2px, transparent 2.2px) 0 0/28px 28px,
      var(--azul);
    display:flex; flex-direction:column; min-height:100vh;
  }

  header{text-align:center; padding:10px 12px 6px}
  .title{
    font-size: calc(1.8rem + 4pt);
    font-weight:900; margin:0;
    color:var(--bordo);
    text-shadow:-1px -1px 0 var(--ouro), 1px -1px 0 var(--ouro), -1px 1px 0 var(--ouro), 1px 1px 0 var(--ouro);
  }

  .wrap{max-width:640px; margin:0 auto; padding:8px 16px 20px; width:100%}

  .hero{
    display:block; margin:8px auto 14px; max-width:100%; height:auto; max-height:630px;
    border:6px solid var(--bordo);
    box-shadow: 0 0 0 4px var(--ouro), 0 6px 16px var(--shadow);
    border-radius:14px;
  }

  .buttons{display:flex; flex-direction:column; gap:12px; margin-top:6px}
  .btn{
    position:relative; display:flex; align-items:center; justify-content:center; text-align:center;
    text-decoration:none; cursor:pointer; background:#fff;
    color:var(--bordo); font-weight:800; width:70%; margin:0 auto;
    padding:9px 18px; min-height:48px;
    border:3px solid var(--bordo);
    box-shadow: 0 0 0 3px var(--ouro), inset 0 0 0 2.4px rgba(0,0,0,.06), 0 4px 10px var(--shadow);
    border-radius:18px;
    transition:transform .15s ease, background-color .2s ease;
  }
  .btn:hover{transform:scale(1.02); background:#fffdf5}
  .btn[aria-disabled="true"]{opacity:.45; pointer-events:none}
  .btn--primeiro{margin-top:14px;}
  .btn .icon{ position:absolute; left:14px; top:50%; transform:translateY(-50%); width:30px; height:30px; border-radius:50%; object-fit:cover; }

  footer{ margin-top:20px; padding:10px 0 24px; text-align:center }
  .back{
    display:inline-flex; align-items:center; gap:6px; background:#a00000; color:#fff; text-decoration:none; font-weight:800;
    border:1px solid #6f0000; border-radius:8px; padding:.3rem .55rem; font-size:.65rem;
    transform:scale(0.6); transform-origin:center;
  }
  .back svg{width:12px; height:12px; fill:#fff}

  /* mini alerta (erro de carga) */
  .alert{margin:10px auto 0; width:70%; text-align:center; font-size:.85rem; background:#fff3cd; color:#7c5b00; border:1px solid #ffe08a; border-radius:10px; padding:6px 10px; display:none}
</style>
<script>
  function goBackCalendar(){
    try{
      const ref = document.referrer || '';
      if(ref.includes('horas-teste.html')){ location.href='horas-teste.html'; return; }
      if(history.length>1){ history.back(); return; }
      location.href='index-teste.html';
    }catch(e){ location.href='index-teste.html'; }
  }
</script>
</head>
<body>
  <header>
    <h1 class="title">Calendário Litúrgico</h1>
  </header>

  <main class="wrap">
    <img class="hero" src="img/icone-calendario.png" alt="Ícone — Calendário" onerror="this.hidden=true">

    <div id="alert" class="alert">Não foi possível carregar a planilha agora. Os botões abaixo podem ficar desativados.</div>

    <section class="buttons" aria-label="Escolha do ano">
      <a id="btn2024" class="btn btn--primeiro" href="#" data-key="ano_2024">
        <img class="icon" src="img/cruz.png" alt="">
        <span class="label">2024</span>
      </a>

      <a id="btn2025" class="btn" href="#" data-key="ano_2025">
        <img class="icon" src="img/cruz.png" alt="">
        <span class="label">2025</span>
      </a>

      <a id="btn2026" class="btn" href="#" data-key="ano_2026">
        <img class="icon" src="img/cruz.png" alt="">
        <span class="label">2026</span>
      </a>
    </section>
  </main>

  <footer>
    <a class="back" href="#" onclick="goBackCalendar()" aria-label="Voltar">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
      Voltar
    </a>
  </footer>

<script>
// URL da sua aba "calendario" publicada em CSV
const CSV_CALEND = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTSNOwDCcQPyPihUkD8PbrtAmMjV9gcYgCmOXNnAfK6chO41qAAtltEpzl-mlxEvlnMwGQQ-JgKjMI3/pub?gid=630771061&single=true&output=csv';

// Parser robusto (suporta vírgulas entre aspas)
const csvToRows = (csv)=>csv.trim().split(/\r?\n/).map(line=>{
  const out=[]; let cur=''; let q=false;
  for(let i=0;i<line.length;i++){
    const c=line[i];
    if(c==='"'){ if(q && line[i+1]==='"'){ cur+='"'; i++; } else { q=!q; } }
    else if(c===',' && !q){ out.push(cur); cur=''; }
    else { cur+=c; }
  }
  out.push(cur); return out;
});

function setBtnFrom(row, mapIdx){
  const key = row[mapIdx.button_key];
  const url = row[mapIdx.url];
  const enabled = row[mapIdx.enabled];
  const btn = document.querySelector(`a[data-key="${key}"]`);
  if(!btn) return;
  if(url && (enabled==='1' || enabled===1)){
    btn.href = url; btn.target = '_blank'; btn.removeAttribute('aria-disabled');
  } else {
    btn.href = '#'; btn.setAttribute('aria-disabled','true');
  }
}

(async()=>{
  const alertBox = document.getElementById('alert');
  try{
    const res = await fetch(CSV_CALEND + '&t=' + Date.now(), {cache:'no-store'});
    if(!res.ok) throw new Error('HTTP '+res.status);
    const text = await res.text();
    const [head,...rows] = csvToRows(text);
    const idx = Object.fromEntries(head.map((h,i)=>[h.trim(), i]));
    // Esperado: module,page,button_key,url,enabled
    rows.forEach(r=> setBtnFrom(r, idx));
  }catch(err){
    console.warn('[Calendário] Falha ao carregar CSV:', err);
    alertBox.style.display = 'block';
    // Mantém os botões visuais, porém desativados
    ['btn2024','btn2025','btn2026'].forEach(id=>{
      const el=document.getElementById(id); if(!el) return; el.href='#'; el.setAttribute('aria-disabled','true');
    });
  }
})();
</script>
</body>
</html>


