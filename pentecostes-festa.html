<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Festa de Pentecostes</title>
<meta name="theme-color" content="#7a0b0b">
<style>
:root{
  --bordo:#7a0b0b; --dourado:#d6b25a; --texto:#6d0000; --prata:#b0b0b0; --branco:#ffffff;
  --shadow:rgba(0,0,0,.16); --fonte:Arial, Helvetica, sans-serif; --btnIcon:30px;
}
*{box-sizing:border-box;margin:0;padding:0} html,body{height:100%}
body{
  font-family:var(--fonte);
  background:linear-gradient(to top, var(--bordo) 0%, #a33 45%, #c95 78%, var(--dourado) 100%);
  min-height:100vh; display:flex; flex-direction:column; overflow-x:hidden; position:relative;
}
header{text-align:center;padding:24px 10px 8px}
.title{
  color:var(--texto); font-weight:900; font-size:1.9rem;
  text-shadow:-1px -1px 0 var(--prata),1px -1px 0 var(--prata),-1px 1px 0 var(--prata),1px 1px 0 var(--prata);
}
.wrap{max-width:640px;margin:0 auto;padding:12px 16px 22px;width:100%}
.hero{
  display:block; margin:10px auto 16px; height:360px; width:auto; aspect-ratio:3/4;
  object-fit:cover; max-height:560px;
  border:4px solid var(--prata);
  box-shadow:inset 0 0 0 4px var(--branco),0 8px 16px var(--shadow);
  border-radius:14px
}
.list{display:flex;flex-direction:column;gap:12px;margin-top:6px}
.btn{
  display:grid; grid-template-columns:var(--btnIcon) 1fr var(--btnIcon); align-items:center; text-align:center;
  background:#fff; color:var(--texto); text-decoration:none; font-weight:900;
  border:3px solid var(--prata); box-shadow:inset 0 0 0 3px var(--branco),0 4px 10px var(--shadow);
  border-radius:18px; padding:6px 18px; width:94%; margin:0 auto; transition:transform .12s,filter .2s;
}
.btn:hover{transform:scale(1.02);filter:brightness(1.04)}
.btn:focus-visible{outline:3px solid var(--dourado); outline-offset:3px}
.btn[aria-disabled="true"]{opacity:.55; pointer-events:none; filter:grayscale(.2)}
.btn .icon{
  width:var(--btnIcon); height:var(--btnIcon); border-radius:50%;
  border:2px solid var(--prata); box-shadow:inset 0 0 0 2px var(--branco); object-fit:cover
}
.btn .label{
  text-align:center; color:var(--texto);
  text-shadow:-1px -1px 0 var(--prata),1px -1px 0 var(--prata),-1px 1px 0 var(--prata),1px 1px 0 var(--prata)
}
.btn .slot{width:var(--btnIcon); height:var(--btnIcon)}
/* Voltar (filha → mãe) — 40% menor (scale .6) */
.back-wrap{display:flex;justify-content:center;margin-top:6px;transform:scale(.6);transform-origin:center top}
.btn-back{
  display:inline-flex; align-items:center; gap:10px; background:#a00000; color:#fff;
  border:none; border-radius:999px; padding:10px 16px; font-weight:800; box-shadow:0 6px 14px var(--shadow); cursor:pointer
}
.btn-back .arr{font-size:18px; line-height:1}
.btn-back:focus-visible{outline:3px solid var(--dourado); outline-offset:4px}
@media (prefers-reduced-motion: reduce){
  .btn,.btn:hover{transition:none; transform:none; filter:none}
}
</style>
<script>
function goBackOrMother(){
  const mother = document.body.dataset.mother || 'pentecostes.html';
  try{
    const ref = document.referrer || '';
    if (ref && (new URL(ref, location.href)).pathname.endsWith('/' + mother)) { history.back(); return; }
    if (history.length > 1) { history.back(); return; }
  }catch(e){}
  location.href = mother;
}
</script>
</head>
<body data-mother="pentecostes.html">
<header><h1 class="title">Festa de Pentecostes</h1></header>

<main class="wrap">
  <img class="hero" src="img/icone-pentecostes.jpg" alt="Ícone — Pentecostes" onerror="this.style.display='none'">

  <section class="list" aria-label="Ofícios">
    <a class="btn" data-key="ramsho" href="#" target="_blank" rel="noopener noreferrer">
      <img class="icon" src="img/icone-pentecostes.jpg" alt="Pentecostes"><span class="label">Ramsho</span><span class="slot" aria-hidden="true"></span>
    </a>
    <a class="btn" data-key="safro" href="#" target="_blank" rel="noopener noreferrer">
      <img class="icon" src="img/icone-pentecostes.jpg" alt="Pentecostes"><span class="label">Safro</span><span class="slot" aria-hidden="true"></span>
    </a>
  </section>

  <div class="back-wrap">
    <button class="btn-back" type="button" onclick="goBackOrMother()" aria-label="Voltar para a página anterior ou mãe">
      <span class="arr" aria-hidden="true">←</span><span>Voltar</span>
    </button>
  </div>
</main>

<script>
// === Configuração de planilha (mesma Planilha B) ===
const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTSNOwDCcQPyPihUkD8PbrtAmMjV9gcYgCmOXNnAfK6chO41qAAtltEpzl-mlxEvlnMwGQQ-JgKjMI3/pub?gid=1354083639&single=true&output=csv';
const SLUG_MAIN = 'pentecostes'; // coluna A, tudo minúsculo, sem acento

// Parser CSV robusto (respeita aspas e vírgulas internas)
function csvToRows(text){
  const rows=[]; let i=0, cur='', inQ=false; const push=()=>{(rows[rows.length-1]||rows.push([]),rows[rows.length-1]).push(cur); cur='';};
  rows.push([]);
  while(i<text.length){
    const c=text[i];
    if(inQ){
      if(c==='"' && text[i+1]==='"'){ cur+='"'; i+=2; continue; }
      if(c==='"'){ inQ=false; i++; continue; }
      cur+=c; i++; continue;
    }else{
      if(c==='"' ){ inQ=true; i++; continue; }
      if(c===',' ){ push(); i++; continue; }
      if(c==='\r'){ i++; continue; }
      if(c==='\n'){ push(); rows.push([]); i++; continue; }
      cur+=c; i++; continue;
    }
  }
  if(cur.length || (rows[rows.length-1]&&rows[rows.length-1].length)) push();
  // remove última linha vazia, se houver
  if(rows.length && rows[rows.length-1].length===1 && rows[rows.length-1][0]==='') rows.pop();
  return rows;
}

function mapBySlug(rows){
  const by={};
  for(let r=1;r<rows.length;r++){
    const row=rows[r];
    const slug=(row[0]||'').toLowerCase().trim();
    if(!slug) continue;
    by[slug]={
      ramshoCurta: row[2]||'',
      ramshoLonga: row[3]||'',
      safroCurta : row[4]||'',
      safroLonga : row[5]||'',
      salmos     : row[6]||''
    };
  }
  return by;
}

function setLink(a,url){
  if(url){
    a.removeAttribute('aria-disabled');
    a.href=url; a.style.opacity=''; a.style.pointerEvents=''; a.removeAttribute('title'); a.tabIndex=0;
  }else{
    a.setAttribute('aria-disabled','true');
    a.removeAttribute('href'); a.style.opacity=.55; a.style.pointerEvents='none'; a.title='Link não configurado'; a.tabIndex=-1;
  }
}

(async ()=>{
  try{
    const res = await fetch(CSV_URL, {cache:'no-store'});
    const txt = await res.text();
    const rows = csvToRows(txt);
    const data = mapBySlug(rows);
    const main = data[SLUG_MAIN] || {};

    // Dois botões com fallback: longa → curta
    const links = {
      'ramsho': main.ramshoLonga || main.ramshoCurta || '',
      'safro' : main.safroLonga  || main.safroCurta  || ''
    };

    document.querySelectorAll('[data-key]').forEach(a=>{
      const k=a.getAttribute('data-key'); setLink(a, links[k]);
    });
  }catch(e){
    console.error('CSV load error', e);
    // Em caso de falha de rede, mantém botões desativados
    document.querySelectorAll('[data-key]').forEach(a=>setLink(a,''));
  }
})();
</script>
</body>
</html>

