<!-- patristica.html — versão com 4 botões fixos + integração a Google Sheets (CSV) -->
.map(r=>({
author_name: r.author_name || r.name || '',
author_slug: r.author_slug || slugify(r.author_name||''),
order: parseInt(r.order||'999',10),
enabled: (r.enabled==1||r.enabled==='1')?1:0,
icon: r.icon||''
}))
.filter(a=>a.author_name && a.enabled)
.sort((a,b)=>a.order-b.order);


// Carrega links por autor
const linksRows = await fetchCSV(CSV_LINKS);
linksMap = {};
linksRows.forEach(r=>{
const aslug = (r.author_slug||'').trim();
const key = (r.button_key||'').trim().toLowerCase();
if(!aslug || !key) return;
(linksMap[aslug] ||= {});
linksMap[aslug][key] = {
label: r.label||DEFAULT_LABELS[key]||key,
url: (r.url||'').trim(),
enabled: r.enabled
};
});


// Seleciona o autor inicial: hash na URL ou o primeiro da lista
const h = (location.hash||'').replace(/^#/,'');
const pos = h ? autores.findIndex(x=>x.author_slug===h) : -1;
idx = pos>=0 ? pos : 0;
}catch(err){
console.warn('[Patrística] usando fallback estático. Motivo:', err);
// Fallback estático mínimo (mantém página funcional)
autores = [
{author_name:'Santo Efrém', author_slug:'santo-efrem', order:1, enabled:1},
{author_name:'Narsai de Nisibis', author_slug:'narsai-de-nisibis', order:2, enabled:1},
{author_name:'Jacó de Serugh', author_slug:'jaco-de-serugh', order:3, enabled:1},
{author_name:'Isaque de Nínive', author_slug:'isaque-de-ninive', order:4, enabled:1}
];
linksMap = {}; // sem links → botões desabilitados
}
renderAuthor();
})();
</script>
</body>
</html>
