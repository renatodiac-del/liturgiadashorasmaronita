<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Semana da Paixão</title>
<meta name="theme-color" content="#5a0010"><!-- bordô -->
<style>
*{box-sizing:border-box} html,body{height:100%}
:root{
  --ouro:#d6b25a;
  --roxo:#4B0082;             /* contornos e botão voltar */
  --bordo:#5a0010;            /* fundo bordô */
  --shadow:rgba(0,0,0,.16);
  --fonte: Arial, Helvetica, sans-serif;
}
body{
  margin:0; font-family:var(--fonte); color:#1a1a1a;
  background: var(--bordo);
  /* detalhes em mosaico, alternando roxo e ouro */
  background-image:
    repeating-linear-gradient(45deg, rgba(75,0,130,.35) 0 3px, transparent 3px 42px),
    repeating-linear-gradient(-45deg, rgba(214,178,90,.30) 0 3px, transparent 3px 42px);
  background-blend-mode: overlay;
  display:flex; flex-direction:column; min-height:100vh;
}

/* Cabeçalho */
header{display:flex;flex-direction:column;align-items:center;text-align:center;padding:12px 12px 0}
.title{
  color:#a00000; font-weight:900; margin:0; line-height:1.08;
  font-size: calc(1.9rem + 2pt);
  text-shadow:
    -1px -1px 0 var(--roxo), 1px -1px 0 var(--roxo),
    -1px  1px 0 var(--roxo), 1px  1px 0 var(--roxo);
}

/* Área principal */
.wrap{width:100%;max-width:720px;margin:0 auto;padding:10px 16px 16px}
.hero{
  display:block;margin:6px auto 14px;max-width:100%;height:auto;max-height:420px;
  border:6px solid var(--ouro);
  box-shadow:0 0 0 4px var(--roxo) inset, 0 8px 18px var(--shadow);
  border-radius:12px
}
.hero[hidden]{display:none}
.chip{
  display:inline-block;margin:8px 0 14px;padding:10px 14px;background:rgba(255,255,255,.92);
  border:3px solid var(--ouro); box-shadow:0 0 0 2px var(--roxo) inset; border-radius:14px; font-weight:800; color:#4B0082
}

/* Botões: +15% de largura (100% do contêiner) e fonte -1pt */
.buttons{display:flex;flex-direction:column;gap:12px;align-items:center;margin-top:4px}
.btn{
  position:relative;display:inline-flex;align-items:center;justify-content:center;text-decoration:none;cursor:pointer;
  background:#fff;
  border:3px solid var(--roxo);
  box-shadow: inset 0 0 0 3px var(--ouro), 0 4px 10px var(--shadow);
  border-radius:18px;
  width:100%;
  padding:12px 18px;
  font-size: calc(1rem - 1pt);
  font-weight:bold;color:#4B0082;text-align:center;
  transition:transform .15s ease,background-color .2s ease;
}
.btn:hover{transform:scale(1.02);background:#fff8e8}
.btn img{
  position:absolute;left:12px;width:24px;height:24px;object-fit:cover;border-radius:50%;
  border:2px solid var(--ouro);
}
.btn .label{width:100%;text-align:center;pointer-events:none}

/* Setas de dica */
.hints{
  position:fixed; left:0; right:0; display:flex; justify-content:space-between;
  bottom:22vh; pointer-events:none;
}
.arrow{
  font-size:1.8rem; line-height:1; color:#fff;
  opacity:0;
  text-shadow:0 0 8px rgba(0,0,0,.45);
  margin:0 12px;
  animation:blink 1.2s ease-in-out 4;
}
@keyframes blink{0%,100%{opacity:0} 25%,50%{opacity:1} 75%{opacity:0}}

/* Voltar: 35% menor e mais próximo dos botões */
footer{margin-top:10px;text-align:center;padding:8px 0 14px}
.back{
  display:inline-flex; align-items:center; gap:8px; background:var(--roxo); color:#fff; text-decoration:none;
  border:1px solid #2f0656; padding:.36rem .62rem; border-radius:9px;
  font-weight:bold; font-size:.9rem;
  transform: scale(.65);
  transform-origin: center;
}
.back:hover{background:#5e1fb0}
</style>
</head>
<body>
<header>
  <h1 class="title">Semana da Paixão</h1>
</header>

<main class="wrap">
  <img class="hero" id="hero" src="img/icone-paixao.jpg" alt="Ícone Paixão"
       onerror="this.hidden=true;document.getElementById('hero-chip').style.display='inline-block';">
  <div id="hero-chip" class="chip" style="display:none">Semana da Paixão</div>

  <section class="buttons" aria-label="Semana da Paixão — dias e ritos">
    <a class="btn" href="sexta-tentacoes-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Sexta-feira das Tentações de Cristo</span></a>
    <a class="btn" href="sabado-lazaro-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Sábado de Lázaro</span></a>

    <!-- estes dois pegam os links direto da planilha (B8 e B9) -->
    <a class="btn" data-key="porto" href="#"><img src="img/cruz3.png" alt=""><span class="label">Chegada ao Porto</span></a>
    <a class="btn" href="domingo-hosana-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Domingo do Hosana</span></a>
    <a class="btn" data-key="lampada" href="#"><img src="img/cruz3.png" alt=""><span class="label">Rito da Lâmpada</span></a>

    <a class="btn" href="segunda-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Segunda-feira da Paixão</span></a>
    <a class="btn" href="terca-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Terça-feira da Paixão</span></a>
    <a class="btn" href="quarta-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Quarta-feira da Paixão</span></a>
    <a class="btn" href="quinta-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Quinta-feira dos Mistérios</span></a>
    <a class="btn" href="boa-sexta-feira-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Boa Sexta-feira</span></a>
    <a class="btn" href="sabado-luz-paixao.html"><img src="img/cruz3.png" alt=""><span class="label">Sábado da Luz</span></a>
  </section>
</main>

<!-- setas laterais apontando para baixo -->
<div class="hints" aria-hidden="true">
  <div class="arrow">⬇</div>
  <div class="arrow">⬇</div>
</div>

<footer>
  <a class="back" href="javascript:history.back()"
     onclick="if(!document.referrer || !document.referrer.includes('ordinario.html')){this.href='ordinario.html'}">← Voltar</a>
</footer>

<script>
document.getElementById('hero').addEventListener('load',()=>{
  const c=document.getElementById('hero-chip'); if(c) c.style.display='none';
});

/* ====== Links dinâmicos: Chegada ao Porto (B8) e Rito da Lâmpada (B9) ====== */
const CSV_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vTSNOwDCcQPyPihUkD8PbrtAmMjV9gcYgCmOXNnAfK6chO41qAAtltEpzl-mlxEvlnMwGQQ-JgKjMI3/pub?gid=1920452033&single=true&output=csv";

function parseCsv(t){
  const out=[], row=[]; let i=0,f="",q=false;
  while(i<t.length){
    const c=t[i];
    if(q){
      if(c=='"'){ if(t[i+1]=='"'){f+='"'; i++;} else q=false; }
      else f+=c;
    }else{
      if(c=='"') q=true;
      else if(c===","){ row.push(f); f=""; }
      else if(c=="\n"){ row.push(f); out.push(row.slice()); row.length=0; f=""; }
      else if(c!="\r"){ f+=c; }
    }
    i++;
  }
  if(f!="" || row.length){ row.push(f); out.push(row); }
  return out;
}
async function loadCols(){
  const res=await fetch(CSV_URL,{cache:"no-store"});
  const txt=await res.text();
  const rows=parseCsv(txt);
  const cols=[];
  for(let c=0;c<(rows[0]?.length||0);c++){ cols[c]=rows.map(r=>r[c]??""); }
  return cols;
}
function urlAt(cols,colIndex,rowIndex){ return (cols[colIndex]?.[rowIndex]||"").trim(); }

(async()=>{
  const COL_B = 1;      // Coluna B
  const ROW_B8 = 7;     // Linha 8 -> índice 7 (zero-based)
  const ROW_B9 = 8;     // Linha 9 -> índice 8

  const map = {
    "porto":   ROW_B8,  // Chegada ao Porto
    "lampada": ROW_B9   // Rito da Lâmpada
  };

  try{
    const cols = await loadCols();
    document.querySelectorAll("[data-key]").forEach(a=>{
      const key = a.getAttribute("data-key");
      const row = map[key];
      const url = urlAt(cols, COL_B, row);
      if(url){
        a.href = url;
        a.target = "_blank";
        a.rel = "noopener";
      }else{
        a.style.opacity = .6;
        a.style.pointerEvents = "none";
        a.title = "Link não configurado na planilha";
      }
    });
  }catch(e){
    console.error(e);
    document.querySelectorAll("[data-key]").forEach(a=>{
      a.style.opacity=.6; a.style.pointerEvents='none'; a.title='Erro ao carregar links';
    });
  }
})();
</script>
</body>
</html>


