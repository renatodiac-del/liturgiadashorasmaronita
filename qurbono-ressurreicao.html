<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Tempo da Ressurreição — Qurbono</title>
<meta name="theme-color" content="#b4923a">
<style>
  :root{ --ouro:#b4923a; --ouro2:#e8d19b; --prata:#b8b8b8; --txt:#ffffff; --bordtxt:#9c7d2d; --shadow:rgba(0,0,0,.15); --fonte: Arial, Helvetica, sans-serif; }
  *{box-sizing:border-box} html,body{height:100%}
  body{ margin:0;font-family:var(--fonte);color:var(--txt); background: linear-gradient(180deg, var(--ouro) 0%, var(--ouro2) 100%); display:flex; flex-direction:column; min-height:100vh; }
  .wrap{width:100%;max-width:560px;margin:0 auto;padding:8px 14px 10px}
  .title{ text-align:center; font-weight:900; margin:4px 0 6px; font-size:1.8rem;
    text-shadow:-1px -1px 0 var(--bordtxt), 1px -1px 0 var(--bordtxt), -1px 1px 0 var(--bordtxt), 1px 1px 0 var(--bordtxt); }
  .hero{ display:block;margin:0 auto 12px;max-width:100%;height:auto;max-height:380px; border:6px solid var(--prata); box-shadow:0 6px 16px var(--shadow); border-radius:12px }
  .main{ display:block;width:94%;margin:0 auto 8px;padding:12px 14px;text-align:center;text-decoration:none; background:#fff;color:#7a1b1b;font-weight:900;font-size:1.05rem;border-radius:16px; border:3px solid var(--prata); box-shadow:inset 0 0 0 3px var(--ouro), 0 6px 14px var(--shadow) }
  .nav{display:flex;justify-content:center;gap:10px;margin:8px 0 0}
  .nav button{ background:#fff;color:#7a1b1b;font-weight:900;border-radius:12px;border:3px solid var(--prata); padding:8px 12px;cursor:pointer; box-shadow:inset 0 0 0 3px rgba(184,184,184,.8), 0 2px 6px var(--shadow) }
  .nav button:hover{background:#fffaf1}
  footer{text-align:center;margin-top:14px;padding:10px 0 12px}
  .back{ background:#a00000;color:#fff;text-decoration:none;border:none;border-radius:8px;padding:.38rem .7rem;font-weight:900; transform:scale(0.5); transform-origin:center; display:inline-block; }
  .back:hover{background:#c00000}
</style>
</head>
<body>
  <main class="wrap">
    <h1 class="title">Tempo da Ressurreição</h1>
    <img class="hero" src="img/icone-qurbono-ressurreicao.png" alt="">
    <a id="mainLink" class="main" href="#" target="_blank">Carregando…</a>
    <div class="nav">
      <button id="prev">← Anterior</button>
      <button id="next">Próximo →</button>
    </div>
  </main>
  <footer>
    <a class="back" href="javascript:history.back()" onclick="if(!document.referrer||!document.referrer.includes('liturgia-ano.html'))this.href='liturgia-ano.html'">← Voltar</a>
  </footer>

<script>
const CSV_URL='https://docs.google.com/spreadsheets/d/e/2PACX-1vTSNOwDCcQPyPihUkD8PbrtAmMjV9gcYgCmOXNnAfK6chO41qAAtltEpzl-mlxEvlnMwGQQ-JgKjMI3/pub?gid=1467621594&single=true&output=csv';

const linkEl=document.getElementById('mainLink');
const prevBt=document.getElementById('prev');
const nextBt=document.getElementById('next');

let itens=[]; let i=0;

function parseCSV(text){
  const lines=text.split(/\r?\n/).filter(l=>l.trim().length);
  if(!lines.length) return [];
  const head=lines[0].split(',').map(s=>s.trim().toLowerCase());
  const r=head.indexOf('rotulo'), u=head.indexOf('link_doc'), a=head.indexOf('ativo');
  const out=[];
  for(let k=1;k<lines.length;k++){
    const cols=lines[k].split(',');
    const rot=(cols[r]||'').trim(), href=(cols[u]||'').trim(), atv=(cols[a]||'').trim();
    if(!rot) continue;
    out.push({label:rot, href:href||'#', ativo:atv==='1'});
  }
  return out;
}
function firstActiveIndex(v){const x=v.findIndex(t=>t.ativo && t.href && t.href!=='#'); return x>=0?x:0;}
function render(){
  if(!itens.length){ linkEl.textContent='Sem itens'; linkEl.href='#'; linkEl.style.pointerEvents='none'; linkEl.style.opacity=.6; return; }
  const cur=itens[i];
  linkEl.textContent=cur.label||'—';
  if(cur.ativo && cur.href && cur.href!=='#'){ linkEl.href=cur.href; linkEl.style.pointerEvents='auto'; linkEl.style.opacity=1; linkEl.title='Abrir documento'; }
  else { linkEl.href='#'; linkEl.style.pointerEvents='none'; linkEl.style.opacity=.55; linkEl.title='Item inativo'; }
}
function step(d){
  if(!itens.length) return;
  const n=itens.length;
  for(let k=1;k<=n;k++){
    const j=(i+d*k+n)%n, it=itens[j];
    if(it.ativo && it.href && it.href!=='#'){ i=j; break; }
    if(k===n){ i=j; }
  }
  render();
}
prevBt.onclick=()=>step(-1); nextBt.onclick=()=>step(1);

fetch(CSV_URL).then(r=>r.text()).then(t=>{itens=parseCSV(t); i=firstActiveIndex(itens); render();})
.catch(()=>{linkEl.textContent='Erro ao carregar'; linkEl.href='#'; linkEl.style.pointerEvents='none'; linkEl.style.opacity=.6;});
</script>
</body>
</html>

