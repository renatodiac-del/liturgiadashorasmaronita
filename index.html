<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Hora Maronita</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#582c0c">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="https://i.imgur.com/gwRd4N4.png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Lora:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --cor-marrom-monastico: #582c0c;
            --cor-bege-pergaminho: #fdfaf6;
            --cor-dourado-bizantino: #bca37f;
            --cor-verde-cedro: #3a4d39;
            --cor-cinza-escriba: #3d3d3d;
            --fonte-titulos: 'Lora', serif;
            --fonte-corpo: 'Inter', sans-serif;
        }
        body {
            margin: 0;
            background-color: var(--cor-bege-pergaminho);
            background-image: url('https://www.transparenttextures.com/patterns/old-paper.png'); 
            font-family: 'Inter', sans-serif;
            color: var(--cor-cinza-escriba);
            padding: 20px;
        }
        .container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--cor-bege-pergaminho);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); 
            overflow: hidden;
        }
        .santuario-header {
            width: 100%;
            line-height: 0; /* Remove espaço extra abaixo da imagem */
        }
        #imagem-santuario {
            width: 100%;
            height: auto;
            display: block;
        }
        #botoes-navegacao {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 20px 0;
            background-color: #e9e4dE;
            border-top: 1px solid #d4c8b8;
            border-bottom: 1px solid #d4c8b8;
        }
        .botao-nav {
            background-color: var(--cor-verde-cedro);
            color: var(--cor-bege-pergaminho);
            font-family: var(--fonte-corpo);
            font-size: 14px;
            font-weight: 700;
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .botao-nav:hover {
            background-color: #4a6149;
            transform: translateY(-2px);
        }
        #date-navigator { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 1rem 1.5rem; 
            font-family: var(--font-sans);
        }
        #date-navigator button { 
            background: none; 
            border: 1px solid var(--border-color); 
            color: var(--primary-color); 
            padding: 0.5rem 1rem; 
            border-radius: 20px; 
            cursor: pointer; 
            font-size: 0.9rem; 
            transition: background-color 0.2s; 
        }
        #date-navigator button:hover { 
            background-color: #e9e4dE; 
        }
        #current-date-display { 
            font-size: 1.2rem; 
            font-weight: bold; 
            color: var(--primary-color); 
            text-align: center; 
        }
        .conteudo-principal {
            padding: 20px 30px;
            line-height: 1.7;
        }
        .prayer-button { 
            display: block; 
            padding: 1rem; 
            margin-bottom: 0.5rem; 
            text-align: center; 
            background-color: #f1ede9; 
            color: #582c0c; 
            text-decoration: none; 
            border-radius: 8px; 
            font-family: 'Inter', sans-serif; 
            transition: background-color 0.2s; 
        }
        .prayer-button:hover { 
            background-color: #e9e4e0; 
        }
        .rodape-app {
            background-color: #e9e4dE;
            border-top: 1px solid #d4c8b8;
            text-align: center;
            padding: 15px 0;
            font-family: var(--fonte-corpo);
            font-size: 12px;
            color: #706659;
        }
    </style>
</head>
<body>

    <div class="container">
        <header class="santuario-header">
            <img id="imagem-santuario" src="https://drive.google.com/uc?export=view&id=1Onbfp2cUXRixuTlYMAzy3mbQ81gRDxks" alt="Santuário Maronita - Ascensão de Rabbula">
        </header>

        <nav id="botoes-navegacao">
            <button class="botao-nav" id="btn-daily">Liturgia Diária</button>
            <button class="botao-nav" id="btn-ordinario">Ordinário</button>
            <button class="botao-nav" id="btn-comum">Comum dos Santos</button>
        </nav>

        <main class="conteudo-principal">
            <nav id="date-navigator">
                <button id="btn-prev-day">&lt; Dia Anterior</button>
                <div id="current-date-display">Carregando...</div>
                <button id="btn-next-day">Próximo Dia &gt;</button>
            </nav>
            <div id="liturgy-content">
                </div>
        </main>
        
        <footer class="rodape-app">
            <p>Projeto "O Coração Maronita" v8.0</p>
        </footer>
    </div>

    <script>
        // --- FONTES DE DADOS ---
        const dailyLiturgyUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSaYltImPmgdtHoJbz3ce82BdepGLIYM0J3jXGednNbTxtHkn7BhouHUnaKXgtDT1gvBUvY9iJSjDid/pub?gid=0&single=true&output=csv';
        const comumUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSaYltImPmgdtHoJbz3ce82BdepGLIYM0J3jXGednNbTxtHkn7BhouHUnaKXgtDT1gvBUvY9iJSjDid/pub?gid=893557401&single=true&output=csv';

        // --- ELEMENTOS DO DOM ---
        const mainContent = document.getElementById('liturgy-content');
        const dateDisplay = document.getElementById('current-date-display');
        const dateNavigator = document.getElementById('date-navigator');
        
        // --- BOTÕES ---
        const btnPrev = document.getElementById('btn-prev-day');
        const btnNext = document.getElementById('btn-next-day');
        const btnDaily = document.getElementById('btn-daily');
        const btnOrdinario = document.getElementById('btn-ordinario');
        const btnComum = document.getElementById('btn-comum');

        let currentDate = new Date();
        let comumDataCache = null;

        // --- FUNÇÕES DE FORMATAÇÃO E EXIBIÇÃO ---
        function formatarDataParaBusca(date) {
            const ano = date.getFullYear();
            const mes = String(date.getMonth() + 1).padStart(2, '0');
            const dia = String(date.getDate()).padStart(2, '0');
            return `${ano}/${mes}/${dia}`;
        }

        function formatarDataParaExibicao(date) {
            return date.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }
        
        function exibirMensagem(container, mensagem) {
            container.innerHTML = `<div style="font-family: 'Inter', sans-serif; text-align: center; padding: 1rem;">${mensagem}</div>`;
        }
        
        // --- LÓGICA PRINCIPAL ---
        async function buscarOracoesDoDia(date) {
            dateNavigator.style.display = 'flex';
            mainContent.style.display = 'block';
            dateDisplay.textContent = formatarDataParaExibicao(date);
            
            exibirMensagem(mainContent, 'Buscando orações...');
            
            const dataFormatadaBusca = formatarDataParaBusca(date);

            try {
                const response = await fetch(dailyLiturgyUrl);
                if (!response.ok) throw new Error('Falha ao buscar as orações diárias.');
                
                const csvText = await response.text();
                const allRows = csvText.split(/\\r\\n|\\n/);
                const oracoes = [];

                for (let i = 1; i < allRows.length; i++) {
                    const row = allRows[i].trim();
                    if (row) {
                        const columns = row.split(',');
                        if (columns.length >= 5 && columns[0].trim() === dataFormatadaBusca) {
                            oracoes.push({ nome: columns[3].trim().replace(/"/g, ''), link: columns[4].trim().replace(/"/g, '') });
                        }
                    }
                }

                if (oracoes.length > 0) {
                    let botoesHtml = '';
                    oracoes.forEach(item => { botoesHtml += `<a href="${item.link}" target="_blank" class="prayer-button">${item.nome}</a>`; });
                    mainContent.innerHTML = botoesHtml;
                } else {
                    exibirMensagem(mainContent, `Nenhuma Oração Encontrada para o dia ${formatarDataParaExibicao(date)}`);
                }
            } catch (error) {
                exibirMensagem(mainContent, `<strong>Erro:</strong> ${error.message}`);
            }
        }

        async function buscarItensPorTipo(tipo) {
            dateNavigator.style.display = 'none';
            mainContent.style.display = 'block';
            exibirMensagem(mainContent, `Buscando ${tipo}...`);

            try {
                const response = await fetch(dailyLiturgyUrl);
                if (!response.ok) throw new Error(`Falha na rede`);
                const csvText = await response.text();
                const allRows = csvText.split(/\\r\\n|\\n/);
                const itens = [];
                for (let i = 1; i < allRows.length; i++) {
                    const row = allRows[i].trim();
                    if (row) {
                        const columns = row.split(',');
                        if (columns.length >= 5 && columns[0].trim().toUpperCase() === tipo.toUpperCase()) {
                            itens.push({ nome: columns[3].trim().replace(/"/g, ''), link: columns[4].trim().replace(/"/g, '') });
                        }
                    }
                }
                if (itens.length > 0) {
                    let botoesHtml = '';
                    itens.forEach(item => { botoesHtml += `<a href="${item.link}" target="_blank" class="prayer-button">${item.nome}</a>`; });
                    mainContent.innerHTML = botoesHtml;
                } else {
                    exibirMensagem(mainContent, `Nenhum item do ${tipo} encontrado.`);
                }
            } catch (error) {
                exibirMensagem(mainContent, `<strong>Erro:</strong> ${error.message}`);
            }
        }

        async function exibirMenuComum() {
            dateNavigator.style.display = 'none';
            mainContent.style.display = 'block';
            exibirMensagem(mainContent, 'Carregando categorias...');
            try {
                if (!comumDataCache) {
                    const response = await fetch(comumUrl);
                    if (!response.ok) throw new Error(`Falha na rede`);
                    comumDataCache = await response.text();
                }
                const categorias = new Set();
                const allRows = comumDataCache.split(/\\r\\n|\\n/);
                for (let i = 1; i < allRows.length; i++) {
                    const row = allRows[i].trim();
                    if (row) {
                        const columns = row.split(',');
                        if (columns.length > 0 && columns[0].trim()) {
                            categorias.add(columns[0].trim().replace(/"/g, ''));
                        }
                    }
                }
                if (categorias.size > 0) {
                    let botoesHtml = '';
                    categorias.forEach(cat => {
                        botoesHtml += `<a href="#" onclick="event.preventDefault(); buscarComumPorCategoria('${cat.replace(/'/g, "\\'")}')" class="prayer-button">${cat}</a>`;
                    });
                    mainContent.innerHTML = botoesHtml;
                } else {
                    exibirMensagem(mainContent, 'Nenhuma categoria do Comum encontrada.');
                }
            } catch (error) {
                 exibirMensagem(mainContent, `<strong>Erro:</strong> ${error.message}`);
            }
        }

        function buscarComumPorCategoria(categoria) {
            exibirMensagem(mainContent, `Buscando orações para ${categoria}...`);
            const oracoes = [];
            const allRows = comumDataCache.split(/\\r\\n|\\n/);
            for (let i = 1; i < allRows.length; i++) {
                const row = allRows[i].trim();
                if (row) {
                    const columns = row.split(',');
                    if (columns.length >= 3 && columns[0].trim().replace(/"/g, '') === categoria) {
                        oracoes.push({ nome: columns[1].trim().replace(/"/g, ''), link: columns[2].trim().replace(/"/g, '') });
                    }
                }
            }
            if (oracoes.length > 0) {
                let botoesHtml = '';
                oracoes.forEach(item => { botoesHtml += `<a href="${item.link}" target="_blank" class="prayer-button">${item.nome}</a>`; });
                mainContent.innerHTML = botoesHtml;
            } else {
                exibirMensagem(mainContent, `Nenhuma oração encontrada para ${categoria}.`);
            }
        }

        // --- EVENT LISTENERS ---
        btnPrev.addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() - 1);
            buscarOracoesDoDia(currentDate);
        });
        btnNext.addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() + 1);
            buscarOracoesDoDia(currentDate);
        });
        
        btnDaily.addEventListener('click', () => {
            currentDate = new Date(); 
            buscarOracoesDoDia(currentDate);
        });
        btnOrdinario.addEventListener('click', () => buscarItensPorTipo('ORDINARIO'));
        btnComum.addEventListener('click', exibirMenuComum);

        // --- INICIALIZAÇÃO ---
        document.addEventListener('DOMContentLoaded', () => {
            buscarOracoesDoDia(currentDate);
        });
    </script>
</body>
</html>



























