<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hora Sexta</title>
<style>
  :root{ --dourado:#a9842b; --musgo:#556B2F; --vermelho:#a00000; --sombra:rgba(0,0,0,.18); }
  *{box-sizing:border-box}
  body{
    margin:0;font-family:Arial,Helvetica,sans-serif;color:#333;
    background:linear-gradient(#fff6d1,#ffa94d);
    position:relative; overflow-x:hidden; min-height:100vh; display:flex; flex-direction:column;
  }
  body::before{
    content:""; position:fixed; top:-19.38vh; left:50%; transform:translateX(-50%);
    width:38.76vh; height:38.76vh; border-radius:50%;
    background:radial-gradient(circle at 50% 50%, #fff9db 0%, #ffe89a 38%, #ffd161 62%, rgba(255,209,97,0) 63%);
    box-shadow:0 0 40px 18px rgba(255,236,170,.6), 0 0 120px 40px rgba(255,193,61,.25);
    z-index:0; pointer-events:none;
  }
  header{ text-align:center; padding:12px 12px 0; position:relative; z-index:1; }
  .titulo{ margin:0; line-height:1.05; font-weight:900; letter-spacing:.6px; font-size:40px; color:#d6b25a; -webkit-text-stroke:1px var(--dourado); text-shadow:0 1px 0 rgba(0,0,0,.10); }
  .subtitulo{ margin:6px 0 10px; color:var(--musgo); font-size:25px; font-weight:700; }

  .hero-oval{
    display:block; margin:clamp(8px, 10vh, 140px) auto 8px;
    width:min(90vw, 517px); aspect-ratio:3/4; border-radius:38% / 50%;
    border:6px solid var(--dourado); overflow:hidden; box-shadow:0 6px 18px var(--sombra);
    position:relative; z-index:1; background:#000;
  }
  .hero-oval .hero-img{ width:100%; height:100%; object-fit:cover; object-position:50% 45%; display:block; border:0; }

  .wrap{ max-width:600px; margin:0 auto; padding:6px 20px 4px; display:flex; flex-direction:column; gap:8px; align-items:center; position:relative; z-index:1; }
  .btn{
    position:relative; display:flex; align-items:center; justify-content:flex-start; text-decoration:none; background:#fff;
    border:2px solid var(--dourado); border-radius:14px; width:55%; min-width:280px; min-height:33px; padding:4px 12px;
    box-shadow:0 4px 10px var(--sombra); color:#d6b25a; text-align:center; font-weight:800; transition:transform .08s, box-shadow .12s; overflow:hidden; margin:0 auto;
  }
  .btn:hover{ transform:translateY(-1px); box-shadow:0 6px 14px var(--sombra); }
  .btn .icon-round{ width:32px; height:32px; border-radius:50%; object-fit:cover; border:2px solid var(--dourado); box-shadow:0 0 0 2px #fff inset; background:#fff; margin-right:10px; flex:0 0 auto; }
  .btn .label{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; flex-direction:column; gap:0; pointer-events:none; }
  .btn .main{ font-size:21px; line-height:1.06; -webkit-text-stroke:.8px var(--dourado); color:currentColor; }

  footer{ text-align:center; margin:0 0 20px; position:relative; z-index:1; }
  .btn-voltar{
    display:inline-flex; align-items:center; gap:8px; background:var(--vermelho); color:#fff; text-decoration:none;
    border:none; border-radius:999px; padding:6px 12px; font-weight:800; font-size:12px; box-shadow:0 3px 8px var(--sombra); transform:scale(.6);
  }
</style>
</head>
<body>
  <header>
    <h1 class="titulo">Hora Sexta</h1>
    <div class="subtitulo">12 horas</div>
    <figure class="hero-oval"><img class="hero-img" src="img/icone-sexta.horas.jpg" alt="Ícone principal Sexta"></figure>
  </header>

  <main class="wrap">
    <a id="btn-oracao" href="#" class="btn"><img class="icon-round" src="img/cedro.jpg" alt="Cedro"><span class="label"><span class="main">Oração</span></span></a>
    <a id="btn-hinos" href="#" class="btn"><img class="icon-round" src="img/cedro.jpg" alt="Cedro"><span class="label"><span class="main">Hinos e Melodias</span></span></a>
  </main>

  <footer>
    <a class="btn-voltar" href="horas-teste.html">← voltar</a>
  </footer>

<script>
const HORAS_MENU_CSV_URL='https://docs.google.com/spreadsheets/d/SEU_ID/export?format=csv';
const PAGE_SLUG='sexta';

const norm=s=> (s||'').normalize('NFD').replace(/[\u0300-\u036f]/g,'').trim().toLowerCase();
function toISO(d){const s=(d||'').replace(/[-.]/g,'/').trim();const p=s.split('/');if(p.length!==3)return null;if(p[0].length===4){const[y,m,da]=p;return`${y}-${m.padStart(2,'0')}-${da.padStart(2,'0')}`;}const[da,m,y]=p;return`${y}-${m.padStart(2,'0')}-${da.padStart(2,'0')}`;}
function parseCSV(t){const r=[];let i=0,c=[],v='',q=false;while(i<t.length){const ch=t[i++];if(q){if(ch=='"'&&t[i]=='"'){v+='"';i++;}else if(ch=='"'){q=false;}else v+=ch;}else{if(ch===','){c.push(v);v='';}else if(ch=='"'){q=true;}else if(ch=='\n'){c.push(v);r.push(c);c=[];v='';}else if(ch!=='\r'){v+=ch;}}}if(v.length||c.length){c.push(v);r.push(c);}return r;}
async function fetchCSV(u){const cb=Math.floor(Date.now()/60000);const u1=u+(u.includes('?')?'&':'?')+'cb='+cb;try{const r=await fetch(u1);if(!r.ok)throw new Error(r.status);return await r.text();}catch(e){const p='https://api.allorigins.win/raw?url='+encodeURIComponent(u1);const r=await fetch(p);if(!r.ok)throw new Error('fallback '+r.status);return await r.text();}}
function q(name){return new URLSearchParams(location.search).get(name)}
function todayISO(){const d=new Date(),y=d.getFullYear(),m=String(d.getMonth()+1).padStart(2,'0'),da=String(d.getDate()).padStart(2,'0');return`${y}-${m}-${da}`;}

(async function(){
  const iso = q('d')&&/^\d{4}-\d{2}-\d{2}$/.test(q('d'))? q('d'): todayISO();
  const txt = await fetchCSV(HORAS_MENU_CSV_URL);
  const rows = parseCSV(txt).filter(r=>r.join('').trim()!=='');
  const head = rows.shift().map(h=>norm(h));
  const idx = (names)=> names.map(n=>head.indexOf(norm(n))).find(i=>i>=0);

  const iDate=idx(['date','data','dia']);
  const iSlug=idx(['page_slug','pagina','page']);
  const iKey =idx(['option_key','key','opcao','opção']);
  const iLab =idx(['label','rotulo','rótulo']);
  const iUrl =idx(['url','link','doc','arquivo']);
  const iTgt =idx(['target','alvo']);
  const iOrd =idx(['order','ordem','pos']);
  const iEn  =idx(['enabled','ativo','publicado']);

  const all = rows.filter(r=>norm(r[iSlug])===norm(PAGE_SLUG) && (iEn<0 || String(r[iEn]).trim()!=='0'));
  const today = all.filter(r=>{const d=(iDate>=0?(r[iDate]||''): '').trim(); return d && toISO(d)===iso;});
  const base  = all.filter(r=>{const d=(iDate>=0?(r[iDate]||''): '').trim(); return !d;});
  const use = (today.length? today: base).map(r=>({
    key: iKey>=0?(r[iKey]||''):'',
    label: r[iLab]||'',
    url: iUrl>=0?(r[iUrl]||''):'',
    target: (iTgt>=0?(r[iTgt]||''):'_blank')||'_blank',
    order: iOrd>=0? Number(r[iOrd]||0): 0
  })).sort((a,b)=>a.order-b.order);

  const map = {'oracao':'btn-oracao','hinos-melodias':'btn-hinos'};
  use.forEach(it=>{
    const a = document.getElementById(map[it.key]);
    if(!a) return;
    a.href = it.url || '#';
    a.target = it.target || '_blank';
    if(it.label){ a.querySelector('.main')?.replaceChildren(it.label); }
    if(!it.url){ a.setAttribute('aria-disabled','true'); a.style.opacity='.45'; a.style.pointerEvents='none';}
  });
})();
</script>
</body>
</html>


